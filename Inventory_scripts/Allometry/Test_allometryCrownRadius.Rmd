---
title: "Untitled"
author: "Vincyane"
date: "`r Sys.Date()`"
output: html_document
---

# 1. Simulation des données (ou importation de vos données)
```{r}
set.seed(123)
# Simuler des données
n <- 100
DBH <- runif(n, 5, 50)  # Diamètre à la hauteur de poitrine (DBH)
alpha <- 2
beta <- 0.8
epsilon <- rnorm(n, mean = 0, sd = 0.2)  # Bruit aléatoire
Y <- exp(alpha + epsilon) * DBH^beta  # Relation allométrique
data <- data.frame(DBH, Y)
```

# 2. Transformée log-log et estimation linéaire initiale
Cela fournit des valeurs initiales pour α et β.
```{r}
# Transformation log-log
data$log_DBH <- log(data$DBH)
data$log_Y <- log(data$Y)

# Modèle linéaire pour estimation initiale
lm_fit <- lm(log_Y ~ log_DBH, data = data)
summary(lm_fit)

# Estimations initiales
alpha_init <- coef(lm_fit)[1]
beta_init <- coef(lm_fit)[2]
```

# 3. Régression non linéaire avec nls
```{r}
# Ajustement avec nls
nls_fit <- nls(Y ~ exp(alpha) * DBH^beta,
               data = data,
               start = list(alpha = alpha_init, beta = beta_init))
summary(nls_fit)

# Récupérer les paramètres estimés
coef <- coef(nls_fit)
coef["alpha"];coef["beta"]
```

# 4. Analyse des résultats
Vérifiez les ajustements et la qualité du modèle :

```{r}
# Prédictions
data$Y_pred <- predict(nls_fit)

# Graphique de validation
library(ggplot2)
ggplot(data, aes(x = DBH, y = Y)) +
  geom_point() +
  geom_line(aes(y = Y_pred), color = "blue") +
  labs(title = "Ajustement du modèle allométrique", y = "Y", x = "DBH") +
  theme_minimal()
```

```{r}
n <- 10000
DBH <- runif(n, 5, 150)  # Diamètre à la hauteur de poitrine (DBH)
Y <- exp(coef["alpha"]) * (DBH^coef["beta"])
data <- data.frame(DBH, Y)
ggplot(data, aes(x = DBH, y = Y)) +
  geom_point() +
  geom_line(color = "blue") +
  labs(title = "Ajustement du modèle allométrique", y = "Y", x = "DBH") +
  theme_minimal()
```

