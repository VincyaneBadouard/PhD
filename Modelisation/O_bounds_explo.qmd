---
title: "O bounds exploration"
date: "`r Sys.Date()`"
format: html
self-contained: true
theme: cosmo
editor: source
code-fold: true
---

mais l'idée là c'est de le refaire pour une autre gamme de l'enviro puisqu'on le logge (genre -8; 0). Et de tester si on peut retrouver toutes les formes, pas que la sigmoide negative. Et pour élargir a et gamma, explore, l'idée est de tester si tu peux retrouver toutes les formes. Si au dela (ou plutôt en deça) d'une certaine valeur de a toutes les courbes sont pareilles pour une valeur fixe des autres paramètres, ça ne vaut plus la peine d'explorer plus loin

refaire pour une autre gamme de l'enviro puisqu'on le logge (genre -8; 0). Et de tester si on peut **retrouver toutes les formes**, pas que la sigmoide negative. Et pour élargir a et gamma, explore, l'idée est de tester si tu peux retrouver toutes les formes. Si au dela (ou plutôt en deça) d'une **certaine valeur de a toutes les courbes sont pareilles** pour une valeur fixe des autres paramètres, ça ne vaut plus la peine d'explorer plus loin

log ou log 10 ?

**Objectives:**
Sigmoid optimum can be estimated outside of the environmental range.  
To have a reasonable quadratic optimum for the sigmoid case, we want to bound "O", for that we need to explore what are acceptable bounds.  

a = beta2  
O = extremum : -beta1/(2*beta2)  
gamma = alpha-(beta1^2/4*beta2)  

- without model fit  
- a : -10, -100 (<0 to force concave form)  
- gamma : -2, 0.2  
- O : -0.75, -0.5, -0.25, 0 (<0 to simulate a negativ sigmoid on 0-1)  
- iota (interaction parameter) after  
- plot lines on env in abscissa  

https://www.alloprof.qc.ca/fr/eleves/bv/mathematiques/le-role-des-parametres-dans-une-fonction-polynom-m1127  

```{r, packages, include = F}
library(tidyverse)
```

# Parameters table
```{r}
# Generates all combination of parmeters (12)

# a = c(-1, -5, -10),
#   gamma = c(-1, 0, 1)

tidyr::crossing(
  a = c(300, 10, 5, 1, -0.5, -1, -5, -10, -25), #c(-10, -25, -50, -100),
  O = c(-.75, -.5, -.25, 0, .25, .5, .75, 1),
  gamma = c(-20, -10, -4, -2, -1, 0, 1, 2, 10, 15, 50, 100),
  Environment = (seq(-1,1, length.out =50)) # 0.001
) %>% 
  mutate(P = 1 / (1 + exp(-(a * (Environment - O)^2 + gamma)))) %>% 
  unite(a, O, gamma, col = "Combinaison", sep = " ", remove = F) %>% 
  mutate(Combinaison = as.factor(Combinaison)) %>% 
  
  ggplot(aes(x=Environment, y=P, col = as.factor(O), group = paste(O, a, gamma))) +
  # xlim(0,1) +
  geom_line(linewidth=1) +
  facet_grid(a ~ gamma, labeller = label_both) +
  theme_bw()  #+
# scale_color_viridis_c()

# ggsave("Explo_parameters_canonic_quadratic.png", path = "D:/Mes Donnees/PhD/Figures/Art", width = 25, height = 15, units = "cm", dpi=800, bg="white")
```
-> gamma = hauteur de la parabole
-> a = ouverture de la parabole
-> O : valeur en x sur laquelle est centrée la parabole

-> acceptable bounds for "O":  
Dépend de gamma et de a,  
plus gamma est fort plus on peut prendre des bornes de "O" larges,    
plus a est faible en absolu, plus on peut prendre des bornes de "O" larges.  
-> il vaut mieux prendre les bornes les plus proches possible du range environnemental



